# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **markdown**: Add MarkdownParser class
- **markdown**: Register MarkdownParser in parser registry
- **text**: Implement TextParser with encoding detection and chapter detection

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow
- **markdown**: Improve word counting, heading normalization, and image format detection
- **text**: Fix word count mismatch and implement PR review feedback

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md

### Performance

- **markdown**: Add regex compilation optimization and metadata validation

### Testing

- **markdown**: Add test fixtures for markdown parser
- **markdown**: Add comprehensive unit tests for MarkdownParser
- **markdown**: Add integration tests for MarkdownParser

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **markdown**: Add MarkdownParser class
- **markdown**: Register MarkdownParser in parser registry
- **text**: Implement TextParser with encoding detection and chapter detection

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow
- **markdown**: Improve word counting, heading normalization, and image format detection
- **text**: Fix word count mismatch and implement PR review feedback

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md

### Testing

- **markdown**: Add test fixtures for markdown parser
- **markdown**: Add comprehensive unit tests for MarkdownParser
- **markdown**: Add integration tests for MarkdownParser

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **markdown**: Add MarkdownParser class
- **markdown**: Register MarkdownParser in parser registry

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow
- **markdown**: Improve word counting, heading normalization, and image format detection

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md
- Update CHANGELOG.md

### Testing

- **markdown**: Add test fixtures for markdown parser
- **markdown**: Add comprehensive unit tests for MarkdownParser
- **markdown**: Add integration tests for MarkdownParser

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **markdown**: Add MarkdownParser class
- **markdown**: Register MarkdownParser in parser registry

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md

### Testing

- **markdown**: Add test fixtures for markdown parser
- **markdown**: Add comprehensive unit tests for MarkdownParser
- **markdown**: Add integration tests for MarkdownParser

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **text**: Implement TextParser with encoding detection and chapter detection

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow
- **text**: Fix word count mismatch and implement PR review feedback

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md
- Update CHANGELOG.md
- Update CHANGELOG.md

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **text**: Implement TextParser with encoding detection and chapter detection

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow
- **text**: Fix word count mismatch and implement PR review feedback

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md
- Update CHANGELOG.md

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management
- **text**: Implement TextParser with encoding detection and chapter detection

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development
- Update CHANGELOG.md

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [Unreleased]

### Added

- Add automated changelog generation with git-cliff
- Add release-please for automated version management

### Fixed

- Update changelog workflow to use git-cliff-action v4
- Configure git-cliff to use prepend mode instead of regenerating changelog
- Remove conflicting OUTPUT env variable from git-cliff workflow

### Documentation

- Update CHANGELOG.md
- Add troubleshooting for changelog content loss and tag requirements
- Update CHANGELOG.md
- Update CHANGELOG.md
- Add comprehensive agent prompts for parallel parser development

### Miscellaneous Tasks

- Move files and updated cliff.toml file

### Miscellaneous Tasks

- Move files and updated cliff.toml file

## [0.1.0] - 2025-10-23

### Summary
First development release featuring a production-ready EPUB parser with comprehensive testing. This release establishes the foundation for OmniParser's universal document parsing platform with full EPUB support.

### Added - Phase 1: Planning & Research (2025-10-16)
- Complete project specification (36,000 words)
- Architecture planning with 16-phase implementation plan (40,000 words)
- Implementation reference guide (16,000 words)
- Architecture diagrams with 14 Mermaid visualizations (37,000 words)
- Git commit style guide and development standards
- Initial project structure and configuration

### Added - Phase 2.1: Foundation (2025-10-16)
- **Core Data Models** (318 lines in models.py):
  - `Document` - Universal document representation
  - `Chapter` - Chapter structure with position tracking
  - `Metadata` - Document metadata (Dublin Core fields)
  - `ImageReference` - Image tracking with format detection
  - `ProcessingInfo` - Parser execution metadata
  - Serialization methods: to_dict, from_dict, save_json, load_json

- **Exception Hierarchy** (145 lines in exceptions.py):
  - `OmniParserError` - Base exception
  - `UnsupportedFormatError` - Format not supported
  - `ParsingError` - Generic parsing error
  - `FileNotFoundError` - File not found
  - `InvalidFileError` - Invalid file format
  - `ExtractionError` - Content extraction failed

- **BaseParser Abstract Interface** (99 lines in base/base_parser.py):
  - Abstract base class for all parsers
  - Enforced API contract: parse(), supports_format()
  - Optional methods: extract_images(), clean_text()

- **Utility Modules** (445 lines total):
  - `format_detector.py` (68 lines) - Magic byte format detection
  - `html_extractor.py` (216 lines) - HTML to text conversion
  - `encoding.py` (74 lines) - Character encoding handling
  - `validators.py` (87 lines) - Input validation

- **Testing Infrastructure**:
  - 171 comprehensive unit tests (100% passing)
  - pytest fixtures for all models
  - Test coverage: 87% for foundation components

### Added - Phase 2.2: EPUB Parser (2025-10-20)
- **EPUBParser Implementation** (~1,030 lines in parsers/epub_parser.py):
  - TOC-based chapter detection (primary method)
  - Spine-based chapter fallback (for EPUBs without TOC)
  - Complete metadata extraction from OPF (Dublin Core fields)
  - HTML to Markdown text extraction
  - Image extraction with cleanup
  - Word count and reading time estimation
  - Position tracking for all content

- **Text Processing** (300 lines in processors/text_cleaner.py):
  - YAML-based cleaning pattern configuration
  - Pattern-based text normalization
  - Encoding fixes and whitespace handling
  - No TTS-specific features (clean separation)

- **Main API** (141 lines in parser.py):
  - `parse_document()` - Universal entry point
  - Automatic format detection
  - Parser routing by file type
  - Consistent error handling

- **Testing**:
  - 141 new EPUB parser tests
  - 342 total tests passing (100% success rate)
  - All code Black formatted and mypy strict mode compliant

### Added - Phase 2.3: Integration Testing & Validation (2025-10-20 to 2025-10-23)
- **Real EPUB Test Fixtures** (26MB total):
  - alice-in-wonderland.epub (189KB, 12 chapters, 11 images)
  - frankenstein.epub (476KB, 24 chapters)
  - jekyll-and-hyde.epub (305KB, 10 chapters)
  - moby-dick.epub (816KB, 135 chapters)
  - pride-and-prejudice.epub (24MB, 61 chapters)
  - All public domain from Project Gutenberg

- **Integration Tests** (221 lines in tests/integration/test_epub_parsing.py):
  - 15 integration tests with real EPUB files
  - End-to-end parsing validation
  - Document structure accuracy checks
  - Chapter boundary verification
  - Metadata completeness testing
  - Image extraction validation
  - Performance benchmarks

- **Demo Application** (213 lines in examples/epub_to_markdown.py):
  - Full EPUB to Markdown converter
  - YAML frontmatter with metadata
  - Auto-generated table of contents with anchor links
  - Chapter markers and structure preservation
  - Performance timing and statistics output
  - Comprehensive usage guide in examples/README.md

- **Persistent Image Extraction Feature**:
  - `image_output_dir` parameter for EPUBParser
  - Support for both temporary (default) and persistent directories
  - Obsidian-compatible markdown output
  - Relative image paths for portability
  - Preserves EPUB internal directory structure
  - Backward compatible with existing code

### Performance
- **Target exceeded by 20x**: Parses 5MB EPUB in ~0.25 seconds (vs 5s goal)
- Memory usage well under 500MB for large EPUBs (24MB test file)
- No crashes on malformed EPUBs
- Graceful error handling and informative error messages

### Testing
- **357 total tests** (100% passing)
  - 342 unit tests
  - 15 integration tests
- **>90% code coverage** for EPUB parser components
- **~4,755 lines** of test code
- Real-world validation with Project Gutenberg classics

### Documentation
- Complete architecture and planning documentation
- API documentation for all public classes and methods
- Usage examples and integration guide
- Troubleshooting and best practices
- Git commit style guide

### Technical Details
- **Production code**: ~2,543 lines
- **Test code**: ~4,755 lines
- **Python**: 3.10+ with full type hints
- **Code quality**: Black formatted, mypy strict mode
- **Dependencies**: 14 production dependencies (ebooklib, beautifulsoup4, lxml, ftfy, etc.)
- **License**: MIT

### Known Limitations
- Only EPUB format currently supported (PDF, DOCX, HTML planned for future releases)
- Dependencies for future parsers installed but not yet implemented
- Not yet published to PyPI (install from source)

### Notes for Developers
- Use UV for package management: `uv sync`
- Run tests: `uv run pytest`
- Format code: `uv run black .`
- Type check: `uv run mypy src/`

---

## [Unreleased]

### Planned for Future Releases
- v0.2.1: PDF parser implementation (Phase 2.4)
- v0.3.0: DOCX parser implementation (Phase 2.5)
- v0.4.0: HTML/URL parser implementation (Phase 2.5)
- v0.5.0: Markdown and Text parsers (Phase 2.6)
- v1.0.0: Multi-format release with 3+ parsers, PyPI publication
